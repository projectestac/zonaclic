<!DOCTYPE html>
<html lang="ca">

<head>
  <meta charset="utf-8" />
  <title>Biblioteca de projectes JClic</title>
  <script>
    const searchParams = new URLSearchParams(window.location.search);
    const lang = searchParams.get('lang') || navigator.language.startsWith('ca') ? 'ca' : navigator.language.startsWith('es') ? 'es' : navigator.language.startsWith('en') ? 'en' : 'ca';
    let amp = '';
    const buildParam = (name) => {
      const value = searchParams.get(name);
      const result = value ? `${amp}${name}=${encodeURIComponent(value)}` : '';
      if (!amp)
        amp = value ? '&' : '';
      return result;
    }
    const title = searchParams.get('title');
    const author = searchParams.get('author');
    const buildTextParam = () => {
      const result = title || author ? `${amp}text=${encodeURIComponent(`${title || ''} ${author || ''}`.trim())}` : '';
      if (!amp)
        amp = result ? '&' : '';
      return result;
    }
    const newURL = `https://projectes.xtec.cat/clic/${lang}/repo/?${buildParam('language')}${buildParam('prj')}${buildParam('subject')}${buildParam('level')}${buildParam('subject')}${buildTextParam()}`;
    const redirect = () => window.location.replace(newURL);
    redirect();
  </script>
</head>

<body>
  <a href="#" onclick="redirect();"><img src="../dist/jclic/jclic_64x64.png" alt="Go to the new JClic library"></a>
</body>

</html>